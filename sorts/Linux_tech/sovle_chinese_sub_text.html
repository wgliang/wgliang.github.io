<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>LEFT TEMPLATE</title>
		
		<!-- CSS -->
		<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="../../css/social-icons.css" type="text/css" media="screen" />
	
		<!-- THEME -->
		<link rel="stylesheet" href="../../skins/paper-brown/style.css" type="text/css" media="screen" />
		
		<!-- JS -->
		<script type="text/javascript" src="../../js/jquery-1.5.1.min.js"></script>
		<script type="text/javascript" src="../../js/jqueryui.js"></script>
		<script type="text/javascript" src="../../js/easing.js"></script>
		<script type="text/javascript" src="../../js/jquery.scrollTo-1.4.2-min.js"></script>
		<script type="text/javascript" src="../../js/quicksand.js"></script>
		<script type="text/javascript" src="../../js/custom.js"></script>
		<!--[if IE]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<!-- ENDS JS -->
		
		<!--[if IE 6]>
			<script type="text/javascript" src="js/DD_belatedPNG.js"></script>
			<script>
	      		/* EXAMPLE */
	      		//DD_belatedPNG.fix('*');
	    	</script>
		<![endif]-->
		
		
		<!-- superfish -->
		<link rel="stylesheet" media="screen" href="../../css/superfish.css" /> 
		<link rel="stylesheet" media="screen" href="../../css/superfish-left.css" /> 
		<script type="text/javascript" src="../../js/superfish-1.4.8/js/hoverIntent.js"></script>
		<script type="text/javascript" src="../../js/superfish-1.4.8/js/superfish.js"></script>
		<script type="text/javascript" src="../../js/superfish-1.4.8/js/supersubs.js"></script>
		<!-- ENDS superfish -->
		
		<!-- poshytip -->
		<link rel="stylesheet" href="../../js/poshytip-1.0/src/tip-twitter/tip-twitter.css" type="text/css" />
		<link rel="stylesheet" href="../../js/poshytip-1.0/src/tip-yellowsimple/tip-yellowsimple.css" type="text/css" />
		<script type="text/javascript" src="../../js/poshytip-1.0/src/jquery.poshytip.min.js"></script>
		<!-- ENDS poshytip -->
		
		<!-- Tweet -->
		<link rel="stylesheet" href="../../css/jquery.tweet.css" media="all"  type="text/css"/> 
		<script src="../../js/tweet/jquery.tweet.js" type="text/javascript"></script> 
		<!-- ENDS Tweet -->
		
		<!-- Fancybox -->
		<link rel="stylesheet" href="../../js/jquery.fancybox-1.3.4/fancybox/jquery.fancybox-1.3.4.css" type="text/css" media="screen" />
		<script type="text/javascript" src="../../js/jquery.fancybox-1.3.4/fancybox/jquery.fancybox-1.3.4.pack.js"></script>
		<!-- ENDS Fancybox -->
		
		<!-- jflickrfeed -->
		<link href="../../css/jflickrfeed.css" rel="stylesheet" type="text/css" media="screen" /> 
		<script src="../../js/jflickrfeed/jflickrfeed.js"></script>
		
		<link href="../../js/jflickrfeed/colorbox/colorbox.css" rel="stylesheet" type="text/css" media="screen" /> 
		<script src="../../js/jflickrfeed/colorbox/jquery.colorbox.js"></script>
		<!-- ENDS jflickrfeed -->
		
		<!-- prettyPhoto -->
		<script type="text/javascript" src="../../js/prettyPhoto/js/jquery.prettyPhoto.js"></script>
		<link rel="stylesheet" href="../../js/prettyPhoto/css/prettyPhoto.css" type="text/css" media="screen" />
		<!-- ENDS prettyPhoto -->
		
		
				
		<!-- Nivo slider -->
		<link rel="stylesheet" href="../../css/nivo-slider.css" type="text/css" media="screen" />
		<script src="../../js/nivo-slider/jquery.nivo.slider.js" type="text/javascript"></script>
		<!-- ENDS Nivo slider -->
		
		<!-- tabs -->
		<link rel="stylesheet" href="../../css/tabs.css" type="text/css" media="screen" />
		<script type="text/javascript" src="../../js/tabs.js"></script>
  		<!-- ENDS tabs -->

		<!--[if IE 7]>
			<link rel="stylesheet" type="text/css" media="screen" href="css/ie7-hacks.css" />
		<![endif]-->
		<!--[if IE 8]>
			<link rel="stylesheet" type="text/css" media="screen" href="css/ie8-hacks.css" />
		<![endif]-->
		<!-- ENDS CSS -->	
		
	</head>
	<body>
	
	<!-- WRAPPER -->
	<div id="wrapper">
	
		<!-- SIDEBAR -->
		<div id="sidebar">
			<!-- logo -->
			<a href="index.html"><img src="../../img/logo.jpg" alt="Left template" id="logo" /></a>
						
			<!-- search -->
			<form  method="get" id="searchform" action="#">
				<div>
					<input type="text" value="Search..." name="s" id="s" onfocus="defaultInput(this)" onblur="clearInput(this)" />
					<input type="submit" id="searchsubmit" value=" " />
				</div>
			</form>
			<!-- ENDS search -->
						
			<!-- Navigation -->
			<ul id="nav" class="sf-menu sf-vertical">
				<li class="current-menu-item"><a href="../../index.html">HOME</a></li>
				<li><a href="test1.html">Linux技术</a>
					<ul>
						<li><a href="sovle_chinese_sub_text.html">Linux技术</a>
						<li><a href="#">服务器学习</a>
						<li><a href="#">Web技术学习</a>
						<li><a href="#">数据结构&算法</a>
						<li><a href="#">生活札记</a>
						<li><a href="#">项目</a>
						<li><a href="#">个人简历</a>
					</ul>
				</li>
				<li><a href="#">服务器学习</a></li>
				<li><a href="#">Web技术学习</a>
					<ul>
						<li><a href="#">Image gallery</a>
							<ul>
								<li><a href="#">测试1</a></li>
								<li><a href="#">测试2</a></li>
							</ul>
						</li>
						<li><a href="#">测试3</a></li>
					</ul>
				</li>
				<li><a href="#">数据结构&算法</a>
					<ul>
						<li><a href="#">测试</a></li>
						<li><a href="#">测试</a></li>
					</ul>
				</li>
				<li><a href="#">生活札记</a></li>
				<li><a href="#">项目</a></li>
				<li><a href="#">个人简历</a></li>
			</ul>
			<!-- Navigation -->	
					
			<!-- categories -->
			<ul class="cat-list">
				<li><h6>Categories</h6></li>
				<li><a href="#" title="View posts">Design (11)</a></li>
				<li><a href="#" title="View all posts">Web (6)</a></li> 
				<li><a href="#" title="View all posts">Photo (3)</a></li>
				<li><a href="#" title="View all posts">Coding (16)</a></li>
				<li><a href="#" title="View all posts">Design (41)</a></li>
				<li><a href="#" title="View all posts">Web (6)</a></li> 
				<li><a href="#" title="View all posts">Photo (5)</a></li> 
				<li><a href="#" title="View all posts">Coding (23)</a></li>
			</ul>
			<!-- categories -->	
			
			
			
			<!-- Social -->
			<ul class="social">
				<li><h6>Follow us</h6>
				<li><a href="#" class="facebook" title="Become a fan"></a></li>
				<li><a href="#" class="twitter" title="Follow our tweets"></a></li>
				<li><a href="#" class="dribbble" title="View our work"></a></li>
				<li><a href="#" class="addthis" title="Tell everybody"></a></li>
				<li><a href="#" class="vimeo" title="View our videos"></a></li>
				<li><a href="#" class="youtube" title="View our videos"></a></li>
			</ul>
			<!-- ENDS Social -->

		</div>
		<!-- ENDS SIDEBAR -->
		
		<!-- MAIN -->
		<div id="main">

			<!-- HEADER -->
			<div id="header">
				<div id="page-title">完美解决Linux下Sublime Text中文输入</div>
				<!-- Breadcrumb-->
				<div id="breadcrumbs">
					You are here: 
					<a title="Home" href="#">Home</a> &raquo; 
					<a title="Features" href="#">Linux技术</a> &raquo; 
					<a title="Features" href="#">完美解决Linux下Sublime Text中文输入</a>
				</div>
				<!-- ENDS Breadcrumb-->	
			</div>
			<!-- ENDS HEADER -->
			
			<!-- CONTENT -->
			<div id="content">
						
				<!-- PAGE CONTENT -->
				<div id="page-content">
				
					<!-- Single post -->
					<div class="post single portfolio">
						<!-- feature image -->
						<!-- ENDS feature image -->
						<h4>完美解决Linux下Sublime Text中文输入</h4>
						<!-- meta -->
						<ul class="meta">
							<li> Client Envato &nbsp;</li>
							<li> in <a href="#">Webdesign</a>&nbsp;</li>
						</ul>
						<!-- ENDS meta -->
						<div class="the-content">
							<p>Sublime Text具有漂亮的用户界面和强大的功能，例如代码缩略图，Python的插件，代码段等。还可自定义键绑定，菜单和工具栏。Sublime Text 的主要功能包括：拼写检查，书签，完整的 Python API ， Goto 功能，即时项目切换，多选择，多窗口等等</p>
							
						</div>
					</div>
					<!-- ENDS single post -->
					<p><h6>1、保存下面代码为sublime_imfix.c：</h6></p>
					<!-- Related -->
					<div class="related-projects">
						
						<ul class="related-projects-list">
							
							<li>
								<div class="right-content">
									<strong></strong><br/>
									/*
									<p>	sublime-imfix.c
									<p>	Use LD_PRELOAD to interpose some function to fix sublime input method support for linux.
									<p>	By Cjacker Huang <jianzhong.huang at i-soft.com.cn>

									<p>	gcc -shared -o libsublime-imfix.so sublime_imfix.c  `pkg-config --libs --cflags gtk+-2.0` -fPIC
									<p>	LD_PRELOAD=./libsublime-imfix.so sublime_text
									<p>	*/
									<p>	#include <gtk/gtk.h>
									<p>	#include <gdk/gdkx.h>
									<p>	typedef GdkSegment GdkRegionBox;

									<p>	struct _GdkRegion
									<p>	{
									<p>	  long size;
									<p>	  long numRects;
									<p>	  GdkRegionBox *rects;
									<p>	  GdkRegionBox extents;
									<p>	};

									<p>	GtkIMContext *local_context;

									<p>	void
									<p>	gdk_region_get_clipbox (const GdkRegion *region,
										            GdkRectangle    *rectangle)
									<p>	{
									<p>	  g_return_if_fail (region != NULL);
									<p>	  g_return_if_fail (rectangle != NULL);

									<p>	  rectangle->x = region->extents.x1;
									<p>	  rectangle->y = region->extents.y1;
									<p>	  rectangle->width = region->extents.x2 - region->extents.x1;
									<p>	  rectangle->height = region->extents.y2 - region->extents.y1;
									<p>	  GdkRectangle rect;
									<p>	  rect.x = rectangle->x;
									<p>	  rect.y = rectangle->y;
									<p>	  rect.width = 0;
									<p>	  rect.height = rectangle->height;
									<p>	  //The caret width is 2; 
									<p>	  //Maybe sometimes we will make a mistake, but for most of the time, it should be the caret.
									<p>	  if(rectangle->width == 2 && GTK_IS_IM_CONTEXT(local_context)) {
									<p>	        gtk_im_context_set_cursor_location(local_context, rectangle);
									<p>	  }
									<p>	}

									<p>	//this is needed, for example, if you input something in file dialog and return back the edit area
									<p>	//context will lost, so here we set it again.

									<p>	static GdkFilterReturn event_filter (GdkXEvent *xevent, GdkEvent *event, gpointer im_context)
									<p>	{
									<p>	    XEvent *xev = (XEvent *)xevent;
									<p>	    if(xev->type == KeyRelease && GTK_IS_IM_CONTEXT(im_context)) {
									<p>	       GdkWindow * win = g_object_get_data(G_OBJECT(im_context),"window");
									<p>	       if(GDK_IS_WINDOW(win))
									<p>	         gtk_im_context_set_client_window(im_context, win);
									<p>	    }
									<p>	    return GDK_FILTER_CONTINUE;
									<p>	}

									<p>	void gtk_im_context_set_client_window (GtkIMContext *context,GdkWindow    *window)
									<p>	{
									<p>	  GtkIMContextClass *klass;
									<p>	  g_return_if_fail (GTK_IS_IM_CONTEXT (context));
									<p>	  klass = GTK_IM_CONTEXT_GET_CLASS (context);
									<p>	  if (klass->set_client_window)
										    klass->set_client_window (context, window);

									<p>	  if(!GDK_IS_WINDOW (window))
										    return;
									<p>	  g_object_set_data(G_OBJECT(context),"window",window);
									<p>	  int width = gdk_window_get_width(window);
									<p>	  int height = gdk_window_get_height(window);
									<p>	  if(width != 0 && height !=0) {
									<p>	    gtk_im_context_focus_in(context);
									<p>	    local_context = context;
									<p>	  }
									<p>	  gdk_window_add_filter (window, event_filter, context);
									<p>	}
								</div>
							</li>
							
						</ul>
					</div>
					<!-- ENDS Related -->				
					<div class="post single portfolio">
						<div class="the-content">
							<p><h2>2、编译动态库：</h2></p>
							
						</div>
					</div>
					<!-- ENDS single post -->
					
					<!-- Related -->
					<div class="related-projects">
						<!--<h4>如下：</h4>-->
						<ul class="related-projects-list">
							
							<li>
								<div class="right-content">
									<!--<strong>。。。。</strong><br/>-->
									<p>gcc -shared -o libsublime-imfix.so sublime_imfix.c  `pkg-config --libs --cflags gtk+-2.0` -fPIC
								</div>
							</li>
							
						</ul>
					</div>

					<p>需要自行安装编译环境以及GTK的dev包，GTK的dev包安装方式如下：</p>

					<div class="related-projects">
						<!--<h4>如下：</h4>-->
						<ul class="related-projects-list">
							
							<li>
								<div class="right-content">
									<!--<strong>。。。。</strong><br/>-->
									<p>sudo apt-get install build-essential libgtk2.0-dev
								</div>
							</li>
							
						</ul>
					</div>
                  
                    <div class="post single portfolio">
						<div class="the-content">
							<p><h2>3、设置LD_PRELOAD并启动Sublime Text：</h2></p>
							
						</div>
					</div>
					<!-- ENDS single post -->
					
					<!-- Related -->
					<div class="related-projects">
						<!--<h4>如下：</h4>-->
						<ul class="related-projects-list">
							
							<li>
								<div class="right-content">
									<!--<strong>。。。。</strong><br/>-->
									<p>LD_PRELOAD=./libsublime-imfix.so subl
								</div>
							</li>
							
						</ul>
					</div>

                    <p>为了不用每次启动Sublime Text都打如上代码，可以修改Sublime Text的启动脚本，默认路径为/usr/bin/subl，修改为如下内容，这样就可以在linux下使用Sublime Text进行中文文档编辑了：</p>

					<div class="related-projects">
						<!--<h4>如下：</h4>-->
						<ul class="related-projects-list">
							
							<li>
								<div class="right-content">
									<!--<strong>。。。。</strong><br/>-->
									<p>#!/bin/bash

									<p>	SUBLIME_HOME="/opt/sublime_text"
									<p>	LD_LIB=$SUBLIME_HOME/libsublime-imfix.so
									<p>	sh -c "LD_PRELOAD=$LD_LIB $SUBLIME_HOME/sublime_text $@"
								</div>
							</li>
							
						</ul>
					</div>
				</div>
				<!-- ENDS PAGE-CONTENT -->
			
			</div>
			<!-- ENDS CONTENT -->
			
		</div>
		<!-- ENDS MAIN -->
	</div>
	<!-- ENDS WRAPPER -->

	<!-- FOOTER -->
	<div id="footer">
		<!-- FOOTER-WRAPPER -->
		<div id="footer-wrapper">
			<!-- footer-cols -->
			<ul id="footer-cols">
				<li class="col clear-col">
					<h6>About the theme</h6>
					Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo. Cursus faucibus, tortor neque egestas augue, eu vulputate magna eros eu erat. Aliquam erat volutpat. Nam dui mi, tincidunt quis, accumsan porttitor, facilisis luctus, metus.
				</li>
				<li class="col">
					<h6>Categories</h6>
					<ul>
						<li><a href="#">Webdesign</a></li>
						<li><a href="#/">Wordpress</a></li>
						<li><a href="#">Photo</a></li>
						<li><a href="#">Code</a></li>
						<li><a href="#">Web design</a></li>
						<li><a href="#/">Marketplace</a></li>
						<li><a href="#">Writting</a></li>
						<li><a href="#">Drawings</a></li>
					</ul>
				</li>
				<!-- Flickr -->
				<li class="col">
					<h6>Flickr stream</h6>
					
				</li>
			<!-- ENDS Flickr -->
			</ul>
			<!-- ENDS footer-cols -->
			<!-- footer-bottom -->
			<div id="footer-bottom">
				<div id="bottom-left">
					&copy; 2011 Ansimuz. All Rights Reserved. More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a>
				</div>
				<div id="bottom-right">To top</div>
			</div>
			<!-- ENDS footer-bottom -->
		</div>
		<!-- ENDS FOOTER-WRAPPER -->
	</div>
	<!-- ENDS FOOTER -->
	
	
	</body>
</html>