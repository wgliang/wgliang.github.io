<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../../style/reset.css">
    <link rel="stylesheet" type="text/css" href="../../style/control.css">
    <link rel="stylesheet" href="../../style/app.css">
    <link rel="Shortcut Icon" href="../../image/logo.ico">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Bootstrap Core CSS -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../../css/modern-business.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../../font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <title>二分查找</title>
</head>
<body class="body">

     <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar">我们</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../../index.html">Echo's Blog</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    
                    <li>
                        <a href="../essay/list.html">杂文</a>
                    </li>
                    <li>
                        <a href="../technologes/list.html">技术</a>
                    </li>
                    <li>
                        <a href="../server/list.html">服务器开发</a>
                    </li>
                    <li>
                        <a href="../algorithm/list.html">算法和数据结构</a>
                    </li>
                    <li>
                        <a href="../osandcn/list.html">OS&CN知识汇总</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown"> 翻译 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="../translations/bjnetp/list.html">Beej's网络编程指南</a>
                            </li>
                            <li>
                                <a href="#">未定义</a>
                            </li>
                            <li>
                                <a href="#">未定义</a>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown"> 编程学习系列<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="../programming/python/list.html">Python学习</a>
                            </li>
                            <li>
                                <a href="../programming/c_learn/list.html">C/C++深入学习</a>
                            </li>
                            <li>
                                <a href="../programming/leetcode/list.html">Leetcode题解</a>
                            </li>
                            <li>
                                <a href="../programming/network/list.html">网络编程</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="../project/list.html">项目</a>
                    </li>
                    <li>
                        <a href="../resume.html">简历</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>


    <div class="blog-item"><div id="" class="shadowbox note-content"><h2 class="note-title">二分查找</h2>
<hr>
<p class="note-tags to-remove"><i class="icon-bookmark"></i><code>二分查找</code> <code>面试</code> <code>手写代码</code></p>
<h3>引言</h3>
<p> 二分查找，或许当我们遇到这个算法的时候会觉得很简单，确实如此吗？或许你也听到过，“90%以上的程序员无法正确无误的写出二分查找的代码”，反正我是听到过，无论是在《编程之美》还是《编程珠玑》抑或者网上大牛们的讨论。开始我确实也不信，但是后来发现还是不能够正确无误地完成这个代码。正如《编程珠玑》中说的：<br></p>
<h3></h3>
<p>    <font color ="red">“二分查找可以解决（预排序数组的查找）问题：只要数组中包含 T（即要查找的值）， 那么通过不断缩小包含 T 的范围，最终就可以找到它。一开始，范围覆盖整个数组。将数 组的中间项与 T 进行比较，可以排除一半元素，范围缩小一半。就这样反复比较，反复缩 小范围，最终就会在数组中找到 T，或者确定原以为 T 所在的范围实际为空。对于包含 N 个元素的表，整个查找过程大约要经过 log(2)N 次比较。
    多数程序员都觉得只要理解了上面的描述，写出代码就不难了；但事实并非如此。如果你不认同这一点，最好的办法就是放下书本，自己动手写一写。试试吧。 我在贝尔实验室和 IBM 的时候都出过这道考题。那些专业的程序员有几个小时的时间， 可以用他们选择的语言把上面的描述写出来；写出高级伪代码也可以。考试结束后，差不多所有程序员都认为自己写出了正确的程序。于是，我们花了半个钟头来看他们编写的代码经 过测试用例验证的结果。几次课，一百多人的结果相差无几：90%的程序员写的程序中有 bug（我并不认为没有 bug 的代码就正确）。
    我很惊讶：在足够的时间内，只有大约 10%的专业程序员可以把这个小程序写对。但 写不对这个小程序的还不止这些人：高德纳在《计算机程序设计的艺术 第 3 卷 排序和查 找》第 6.2.1 节的“历史与参考文献”部分指出，虽然早在 1946 年就有人将二分查找的方法 公诸于世，但直到 1962 年才有人写出没有 bug 的二分查找程序。”
    ——乔恩·本特利，《编程珠玑（第 1 版）》第 35-36 页。</p></font>
<h3>分析与解答</h3>
<p>     二分查找很多时候都可以很显著的提高查找效率，思路很简单：依据有序的条件不断的将问题解的区间缩小，直到找到最终解。但它必须满足条件：<font color="blue">查询的序列是有序的或者是变相有序序列(例如efghabcd、4689123之类的)</font>。因此，有时候虽然它的查找效率非常好，但是由于需要将序列先排序而降低了效率，不过在此我们只说它的查找效率，至于它的弊端我们姑且先无视。</p>
<p>     对于二分查找的实现，我们惯常的做法是使用<font color="red">whie()</font>循环，因此程序的关键部分就是初始条件、中间条件、结束条件。如果不注意的话，我们通常会写出这样的代码：</p>
<blockquote>
<pre class="hljs-dark"><code class="hljs javascript"><span class="hljs-string">//有BUG的代码
//查找出大小等于value的值的索引
//array[]为目标数组，n为数组大小，value为目标值
//找到返回值得索引，无符合数值返回-1，可以假设无重复值
int Binary_Search(char[] array, int n, int value){
    int left = 0;
    int right = n-1;
    int mid;
    while(left &lt;= right){
        mid = (left + right)/2;
        if(arrar[mid] &gt; value)
            right = mid-1;
        else if(array[mid] &lt; value)
            left = mid + 1;
        else
            return mid;
    }
    return -1;
}
</span></code></pre>
</blockquote>
<p>     是不是感觉没什么错误呢？
    首先是while()的条件中究竟该&lt;=还是&lt;的问题。如果是 int right = n 的话，那么下面循环的条件则是 while(left &lt; right),循环内当 array[mid]>value 的时候，right = mid。如果是right = n -1的话，那么下面循环的条件则是 while(left &lt;= right),循环内当 array[mid] >value 的时候，right = mid - 1;
    此时面试官或许会说是否考虑溢出呢?即假设是在32位的机器中，如果left+right的和恰好大于2147483647，那么会造成上溢，结果会是一个负数。这个是需要避免的，怎么避免?<font color="blue">(left+right)/2 = (2left + right - left)/2 = left + (right - left)/2</font>，是不是可以解决呢？还有对于除以2的操作，我们还可以采用移位的方式代替，提高了运行效率，即最后是：<font color="red">mid = left + (right - left)>>1</font>.
    另外一个容易出错的地方是一不小心会把，mid = left + (right - left)>>1写在while()循环外面，以至于mid的值得不到更新，不要不以为意，有时候我们就是会犯这种错误。</p>
<blockquote>
<pre class="hljs-dark"><code class="hljs javascript"><span class="hljs-string">//改正后的代码
int Binary_Search(const int array[], int n, int value){
    int left = 0;
    int right = n - 1;
    while(left &lt;= right){
        //如果这里是 int right = n的话，那么下面有两处地方需要修改，以保证一一对应： 
        //1、下面循环的条件则是 while(left &lt; right) 
        //2、循环内当 array[mid]>value 的时候，right = mid

        int mid = left + ((right-left)>>1);//防止溢出
        if(array[mid] > value)
            right = mid - 1;
        else if(array[mid] &lt; value)
            left = mid + 1;
        else
            return mid;
    }
    return -1;
}
</span></code></pre>
</blockquote>
<p>仔细的读者会问，上面说的变相二分查找应该怎样处理，其实就是上面二分查找判断时的处理不同，这个我将在<font color="red">字符串移位</font>的分析中讲解，好吧，今天就到这里吧！</p>
<p><span float="left"><a href="#">&lt;&lt;Prev</a></span>                                                                                                                                                                                                     <span float="right"><a href="#">Next&gt;&gt;</a></span></p>

</div>
  <!-- jQuery Version 1.11.0 -->
    <script src="../../js/jquery-1.11.0.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../../js/bootstrap.min.js"></script>

    <!-- Script to Activate the Carousel -->
    <script>
    $('.carousel').carousel({
        interval: 5000 //changes the speed
    })
    </script>
        <!--兼容版，可保证页面完全兼容-->
<div id="SOHUCS"></div>
<script>
  (function(){
    var appid = 'cyrxhj7os',
    conf = 'prod_34b2ab97462c022b8508b82cbbd8cbbf';
    var doc = document,
    s = doc.createElement('script'),
    h = doc.getElementsByTagName('head')[0] || doc.head || doc.documentElement;
    s.type = 'text/javascript';
    s.charset = 'utf-8';
    s.src =  'http://assets.changyan.sohu.com/upload/changyan.js?conf='+ conf +'&appid=' + appid;
    h.insertBefore(s,h.firstChild);
  })()
</script>

    </div>
</body>
</html>